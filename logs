Running this sequence through the model will result in indexing errors
tokenizing: 228it [00:01, 221.28it/s]
tokenizing: 269it [00:01, 240.60it/s]
tokenizing: 218it [00:00, 260.70it/s]
tokenizing: 311it [00:00, 319.46it/s]
tokenizing: 288it [00:00, 364.99it/s]
----------------------- Task 1 ---------------------------
tokenizing: 2293it [00:07, 325.18it/s]
tokenizing: 275it [00:00, 327.24it/s]
Starting Phase 1 for Task 1: Focal Loss + Label Smoothing
  1%|▊                                                                                      | 144/14400 [01:16<1:43:40,  2.29it/s]Epoch 1/100, Validation Loss: 1.4844153390990362
  2%|█▋                                                                                     | 288/14400 [02:38<1:43:18,  2.28it/s]Epoch 2/100, Validation Loss: 1.440700317422549
  3%|██▌                                                                                    | 432/14400 [04:01<1:42:25,  2.27it/s]Epoch 3/100, Validation Loss: 1.7174892326196034
  4%|███▍                                                                                   | 576/14400 [05:22<1:41:28,  2.27it/s]Epoch 4/100, Validation Loss: 1.603329794274436
  5%|████▎                                                                                  | 720/14400 [06:42<1:40:11,  2.28it/s]Epoch 5/100, Validation Loss: 1.6436754365762074
  6%|█████▏                                                                                 | 864/14400 [08:02<1:39:07,  2.28it/s]Epoch 6/100, Validation Loss: 1.6551674720313814
  7%|██████                                                                                | 1008/14400 [09:22<1:38:01,  2.28it/s]Epoch 7/100, Validation Loss: 1.6949760450257196
Early stopping at epoch 7
  7%|██████                                                                                | 1008/14400 [09:25<2:05:10,  1.78it/s]
acc: 0.5745454545454546   precisionma: 0.43183425857767965  recallma: 0.6156486291486292 recallwei: 0.5745454545454546 weighted-f1: 0.5511276040223407  macro-f1: 0.46676342525026726 mcc: 0.4858270614697721
Phase 1 evaluation for task 1:  (0.5745454545454546, 0.43183425857767965, 0.6156486291486292, 0.5511276040223407, 0.46676342525026726)
Starting Phase 2 for Task 1: Focal Loss + Label Smoothing + EWC
  1%|▊                                                                                      | 144/14400 [01:16<1:44:39,  2.27it/s]Epoch 1/100, Validation Loss: 1.7123456696669261
  2%|█▋                                                                                     | 288/14400 [02:39<1:43:37,  2.27it/s]Epoch 2/100, Validation Loss: 1.6167979372872248
  3%|██▌                                                                                    | 432/14400 [04:02<1:42:36,  2.27it/s]Epoch 3/100, Validation Loss: 1.6727975010871887
  4%|███▍                                                                                   | 576/14400 [05:23<1:41:31,  2.27it/s]Epoch 4/100, Validation Loss: 1.743332326412201
  5%|████▎                                                                                  | 720/14400 [06:43<1:40:25,  2.27it/s]Epoch 5/100, Validation Loss: 1.6923626280493207
  6%|█████▏                                                                                 | 864/14400 [08:03<1:39:11,  2.27it/s]Epoch 6/100, Validation Loss: 1.824288444386588
  7%|██████                                                                                | 1008/14400 [09:23<1:38:19,  2.27it/s]Epoch 7/100, Validation Loss: 1.7949385146299999
Early stopping at epoch 7
  7%|██████                                                                                | 1008/14400 [09:26<2:05:27,  1.78it/s]
acc: 0.5963636363636363   precisionma: 0.47073787618107427  recallma: 0.6169648869648869 recallwei: 0.5963636363636363 weighted-f1: 0.582019688431453  macro-f1: 0.49310493351109597 mcc: 0.5176721526643742
Phase 2 evaluation for task 1:  (0.5963636363636363, 0.47073787618107427, 0.6169648869648869, 0.582019688431453, 0.49310493351109597)
Testing Task 1 model on previous datasets after Phase 2
----------------------Load the best model and test it-----------------------------
acc: 0.5263157894736842   precisionma: 0.3603298915255437  recallma: 0.48089118530294994 recallwei: 0.5263157894736842 weighted-f1: 0.49402825750864965  macro-f1: 0.39231958129016953 mcc: 0.4353939149933384
acc: 0.7806691449814126   precisionma: 0.5883171418907527  recallma: 0.6017848881839487 recallwei: 0.7806691449814126 weighted-f1: 0.7931341363316706  macro-f1: 0.5915326656295115 mcc: 0.7418909621906875
acc: 0.5963302752293578   precisionma: 0.5680103668261564  recallma: 0.5287417407154249 recallwei: 0.5963302752293578 weighted-f1: 0.614092932570905  macro-f1: 0.5274891322924224 mcc: 0.5090081764079534
acc: 0.5980707395498392   precisionma: 0.49040063378285975  recallma: 0.4464070768688445 recallwei: 0.5980707395498392 weighted-f1: 0.5721857139689126  macro-f1: 0.4171384745341453 mcc: 0.5161104247882904
acc: 0.6631944444444444   precisionma: 0.5381828592612906  recallma: 0.5505099827693997 recallwei: 0.6631944444444444 weighted-f1: 0.6437926273333873  macro-f1: 0.49988106442050434 mcc: 0.6036217978998587
----------------------- Task 2 ---------------------------
tokenizing: 2293it [00:06, 347.26it/s]
tokenizing: 2550it [00:07, 339.64it/s]
tokenizing: 285it [00:00, 322.36it/s]
Starting Phase 1 for Task 2: Focal Loss + Label Smoothing
  1%|▊                                                                                      | 160/16000 [01:24<1:58:31,  2.23it/s]Epoch 1/100, Validation Loss: 1.3566611442301009
  2%|█▋                                                                                     | 320/16000 [02:56<1:57:17,  2.23it/s]Epoch 2/100, Validation Loss: 1.4817323519123926
  3%|██▌                                                                                    | 480/16000 [04:25<1:56:26,  2.22it/s]Epoch 3/100, Validation Loss: 1.4067503677474127
  4%|███▍                                                                                   | 640/16000 [05:53<1:55:03,  2.23it/s]Epoch 4/100, Validation Loss: 1.4132097247574065
  5%|████▎                                                                                  | 800/16000 [07:22<1:54:15,  2.22it/s]Epoch 5/100, Validation Loss: 1.4737658732467227
  6%|█████▏                                                                                 | 960/16000 [08:51<1:52:42,  2.22it/s]Epoch 6/100, Validation Loss: 1.4214260644382901
Early stopping at epoch 6
  6%|█████▏                                                                                 | 960/16000 [08:54<2:19:37,  1.80it/s]
acc: 0.6701754385964912   precisionma: 0.6597018539066318  recallma: 0.5900092336103416 recallwei: 0.6701754385964912 weighted-f1: 0.6374574884270174  macro-f1: 0.6029913840163148 mcc: 0.6106377331939379
Phase 1 evaluation for task 2:  (0.6701754385964912, 0.6597018539066318, 0.5900092336103416, 0.6374574884270174, 0.6029913840163148)
Starting Phase 2 for Task 2: Focal Loss + Label Smoothing + EWC
  1%|▊                                                                                      | 160/16000 [01:30<2:06:46,  2.08it/s]Epoch 1/100, Validation Loss: 1.1362562444474962
  2%|█▋                                                                                     | 320/16000 [03:08<2:05:31,  2.08it/s]Epoch 2/100, Validation Loss: 1.6500978271166484
  3%|██▌                                                                                    | 480/16000 [04:42<2:04:46,  2.07it/s]Epoch 3/100, Validation Loss: 1.5552661154005263
  4%|███▍                                                                                   | 640/16000 [06:16<2:02:51,  2.08it/s]Epoch 4/100, Validation Loss: 1.4899583889378443
  5%|████▎                                                                                  | 800/16000 [07:51<2:01:37,  2.08it/s]Epoch 5/100, Validation Loss: 1.513695263200336
  6%|█████▏                                                                                 | 960/16000 [09:25<2:00:19,  2.08it/s]Epoch 6/100, Validation Loss: 1.5351130250427458
Early stopping at epoch 6
  6%|█████▏                                                                                 | 960/16000 [09:29<2:28:37,  1.69it/s]
acc: 0.6842105263157895   precisionma: 0.687208612930175  recallma: 0.6222899353647275 recallwei: 0.6842105263157895 weighted-f1:0.6546773545828458  macro-f1: 0.6337717738239167 mcc: 0.6279880502464621
Phase 2 evaluation for task 2:  (0.6842105263157895, 0.687208612930175, 0.6222899353647275, 0.6546773545828458, 0.6337717738239167)
Testing Task 2 model on previous datasets after Phase 2
----------------------Load the best model and test it-----------------------------
acc: 0.4868421052631579   precisionma: 0.3782194958042416  recallma: 0.47535108638049817 recallwei: 0.4868421052631579 weighted-f1: 0.4344478907172405  macro-f1: 0.37564646094057863 mcc: 0.39303760428164186
acc: 0.8587360594795539   precisionma: 0.7031033411975687  recallma: 0.6904382191240309 recallwei: 0.8587360594795539 weighted-f1: 0.85316923382346  macro-f1: 0.6747039185300705 mcc: 0.8287537263688871
acc: 0.7614678899082569   precisionma: 0.7878107876147092  recallma: 0.8202678413204729 recallwei: 0.7614678899082569 weighted-f1: 0.7869532882619769  macro-f1: 0.7703295312772437 mcc: 0.7069695107026204
acc: 0.7202572347266881   precisionma: 0.6955118309513311  recallma: 0.5880436969273447 recallwei: 0.7202572347266881 weighted-f1: 0.6996064197092052  macro-f1: 0.5976360388813572 mcc: 0.6616355861604021
acc: 0.6840277777777778   precisionma: 0.5666470620556078  recallma: 0.5285521127516887 recallwei: 0.6840277777777778 weighted-f1: 0.641976668969175  macro-f1: 0.5158184392756299 mcc: 0.6237374578902806
----------------------- Task 3 ---------------------------
tokenizing: 4643it [00:13, 355.66it/s]
tokenizing: 2470it [00:07, 330.45it/s]
tokenizing: 279it [00:00, 364.19it/s]
Starting Phase 1 for Task 3: Focal Loss + Label Smoothing
  1%|▊                                                                                      | 155/15500 [01:21<1:54:37,  2.23it/s]Epoch 1/100, Validation Loss: 0.6712726917531755
  2%|█▋                                                                                     | 310/15500 [02:50<1:53:52,  2.22it/s]Epoch 2/100, Validation Loss: 0.7286492702033784
  3%|██▌                                                                                    | 465/15500 [04:16<1:52:50,  2.22it/s]Epoch 3/100, Validation Loss: 0.7351018190383911
  4%|███▍                                                                                   | 620/15500 [05:42<1:51:34,  2.22it/s]Epoch 4/100, Validation Loss: 0.7419927269220352
  5%|████▎                                                                                  | 775/15500 [07:09<1:50:19,  2.22it/s]Epoch 5/100, Validation Loss: 0.7804577946662903
  6%|█████▏                                                                                 | 930/15500 [08:35<1:49:18,  2.22it/s]Epoch 6/100, Validation Loss: 0.7612947738832898
Early stopping at epoch 6
  6%|█████▏                                                                                 | 930/15500 [08:38<2:15:20,  1.79it/s]
acc: 0.8494623655913979   precisionma: 0.7136923581207983  recallma: 0.7060253678936363 recallwei: 0.8494623655913979 weighted-f1: 0.8491788322777333  macro-f1: 0.6821445712593326 mcc: 0.8227452190150042
Phase 1 evaluation for task 3:  (0.8494623655913979, 0.7136923581207983, 0.7060253678936363, 0.8491788322777333, 0.6821445712593326)
Starting Phase 2 for Task 3: Focal Loss + Label Smoothing + EWC
  1%|▊                                                                                      | 155/15500 [01:28<2:03:01,  2.08it/s]Epoch 1/100, Validation Loss: 0.7448234640889697
  2%|█▋                                                                                     | 310/15500 [03:02<2:01:43,  2.08it/s]Epoch 2/100, Validation Loss: 0.7237118962738249
  3%|██▌                                                                                    | 465/15500 [04:36<2:00:10,  2.09it/s]Epoch 3/100, Validation Loss: 0.7732687393824259
  4%|███▍                                                                                   | 620/15500 [06:08<1:59:19,  2.08it/s]Epoch 4/100, Validation Loss: 0.757013178533978
  5%|████▎                                                                                  | 775/15500 [07:39<1:57:50,  2.08it/s]Epoch 5/100, Validation Loss: 0.7964642975065443
  6%|█████▏                                                                                 | 930/15500 [09:11<1:56:16,  2.09it/s]Epoch 6/100, Validation Loss: 0.8069680531819662
  7%|██████                                                                                | 1085/15500 [10:42<1:55:16,  2.08it/s]Epoch 7/100, Validation Loss: 0.788771402504709
Early stopping at epoch 7
  7%|██████                                                                                | 1085/15500 [10:46<2:23:06,  1.68it/s]
acc: 0.8422939068100358   precisionma: 0.7360730257015087  recallma: 0.7095037545534646 recallwei: 0.8422939068100358 weighted-f1: 0.8418016863622712  macro-f1: 0.714664596504417 mcc: 0.8148361309949284
Phase 2 evaluation for task 3:  (0.8422939068100358, 0.7360730257015087, 0.7095037545534646, 0.8418016863622712, 0.714664596504417)
Testing Task 3 model on previous datasets after Phase 2
----------------------Load the best model and test it-----------------------------
acc: 0.5043859649122807   precisionma: 0.3699258350345307  recallma: 0.523566066066066 recallwei: 0.5043859649122807 weighted-f1:0.4434009983718717  macro-f1: 0.4090939056643391 mcc: 0.41475143927306035
acc: 0.8587360594795539   precisionma: 0.6281182595556918  recallma: 0.673273773188367 recallwei: 0.8587360594795539 weighted-f1:0.8506204452301107  macro-f1: 0.6315360078517973 mcc: 0.8291967650379422
acc: 0.8577981651376146   precisionma: 0.7295651409224816  recallma: 0.7798737273806526 recallwei: 0.8577981651376146 weighted-f1: 0.8599056925040945  macro-f1: 0.7444631830030811 mcc: 0.8194276194375616
acc: 0.7588424437299035   precisionma: 0.7491374181450701  recallma: 0.6638793596340766 recallwei: 0.7588424437299035 weighted-f1: 0.7660450261666194  macro-f1: 0.6689574244725268 mcc: 0.7156310174955912
acc: 0.6388888888888888   precisionma: 0.5317268501954692  recallma: 0.5378688838768859 recallwei: 0.6388888888888888 weighted-f1: 0.5973616774510915  macro-f1: 0.5177127988930124 mcc: 0.5808054182184
----------------------- Task 4 ---------------------------
tokenizing: 6913it [00:19, 355.01it/s]